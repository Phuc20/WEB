<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Giỏ hàng - Đồ Ăn Vặt</title>
  <link rel="stylesheet" href="./styles/main.css">
  <link rel="stylesheet" href="./styles/cart.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>
</head>
<body>

<header class="header">
  <div class="header-container">
    <!-- Logo -->
    <div class="logo">
      <a href="main.html">
        <img src="./anvat/ecofood-logo-template.png" alt="Logo Đồ ăn vặt">
      </a>
    </div>
    <!-- Danh mục -->
    <nav class="nav">
      <a href="main.html" class="nav-link">Trang chủ</a>
      <div class="nav-products">
        <span class="nav-link nav-products-title">Sản phẩm <i class="fas fa-chevron-down"></i></span>
        <div class="nav-products-dropdown">
          <a href="main.html#banh-trang-tac">Bánh tráng tắc</a>
          <a href="main.html#banh-trang-bo">Bánh tráng bơ</a>
          <a href="main.html#banh-trang-xi-ke">Bánh tráng xì ke</a>
          <a href="main.html#com-chay">Cơm cháy</a>
          <a href="main.html#com-chay-khoquet">Cơm cháy kho quẹt</a>
          <a href="main.html#com-chay-mohanh">Cơm cháy mỡ hành</a>
          <a href="main.html#keo">Kẹo trái cây</a>
          <a href="main.html#keo-chupa">Kẹo Chupa chups</a>
          <a href="main.html#moc-khoa">Móc khóa lá cờ</a>
        </div>
      </div>
      <a href="about.html" class="nav-link">Giới thiệu</a>
    </nav>
    <!-- Icon giỏ hàng & đăng nhập -->
    <div class="header-actions">
      <a href="Cart.html" class="cart-btn" title="Giỏ hàng">
        <i class="fas fa-shopping-cart"></i>
      </a>
      <a href="login.html" class="login-btn">Đăng Nhập</a>
    </div>
  </div>
</header>

<h1>Giỏ hàng của bạn</h1>

<table id="cartTable" style="display:none;">
  <thead>
  <tr>
    <th>Sản phẩm</th>
    <th>Hình ảnh</th>
    <th>Số lượng</th>
    <th>Giá</th>
    <th>Thành tiền</th>
    <th>Xóa</th>
  </tr>
  </thead>
  <tbody id="cartItems"></tbody>
</table>

<div id="emptyCartMsg" class="empty-cart">Giỏ hàng của bạn đang trống.</div>

<div class="cart-total" id="cartTotal"></div>

<button id="checkoutBtn" style="display:none;">Đặt hàng</button>

<footer>
  <div class="footer-container">
    <div class="footer-logo">
      <img src="./anvat/ecofood-logo-template.png" alt="Logo Đồ ăn vặt">
      <div class="hotline">Hotline: 0819056277</div>
      <div class="hotline-label">GIAO HÀNG NHANH</div>
      <p>Cửa hàng Đồ Ăn Vặt Ngon</p>
      <p>Trường Đại học Công nghệ Thông tin và Truyền thông Việt - Hàn, Đại học Đà Nẵng</p>
      <p>SĐT: +84 ***************</p>
      <p>MST: 01041115527</p>
      <p>Ngày thành lập: 01/04/2025</p>
    </div>
    <div class="footer-section">
      <h3>Giới Thiệu</h3>
      <p>Hệ thống cửa hàng</p>
      <p>Câu chuyện thương hiệu</p>
      <p>Ưu đãi thành viên</p>
      <p>Tin tức & sự kiện</p>
      <p>Tuyển dụng</p>
    </div>
    <div class="footer-section">
      <h3>Liên Hệ</h3>
      <a href="#">Hướng dẫn mua hàng</a><br>
      <a href="#">Chính sách giao hàng</a><br>
      <a href="#">Chính sách bảo mật</a><br>
      <a href="#">Điều khoản và điều kiện</a>
    </div>
    <div class="footer-section">
      <h3>Liên Kết Với Chúng Tôi</h3>
      <div class="social-icons">
        <a href="#"><img src="./anvat/facebook.png" style="width:32px; height:32px; object-fit:contain;" alt="Facebook" /></a>
        <a href="#"><img src="./anvat/tiktok.png" style="width:32px; height:32px; object-fit:contain;" alt="Tiktok" /></a>
        <a href="#"><img src="./anvat/instagram.png" style="width:32px; height:32px; object-fit:contain;" alt="Instagram" /></a>
      </div>
      <div class="certification">
        <img src="./anvat/bocongthuong.png" alt="Đã thông báo Bộ Công Thương">
      </div>
      <h3>Tổng Đài Hỗ Trợ</h3>
      <p>Đặt hàng: 0819056277 (9:30 – 21:30)</p>
      <p>Tổng đài CSKH: 18001056 (9:30 – 21:30)</p>
    </div>
  </div>
</footer>

<script>
  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  const cartItemsEl = document.getElementById('cartItems');
  const cartTable = document.getElementById('cartTable');
  const cartTotalEl = document.getElementById('cartTotal');
  const emptyCartMsg = document.getElementById('emptyCartMsg');
  const checkoutBtn = document.getElementById('checkoutBtn');

  function renderCart() {
    if (cart.length === 0) {
      cartTable.style.display = 'none';
      cartTotalEl.style.display = 'none';
      checkoutBtn.style.display = 'none';
      emptyCartMsg.style.display = 'block';
      return;
    }

    cartTable.style.display = 'table';
    cartTotalEl.style.display = 'block';
    checkoutBtn.style.display = 'block';
    emptyCartMsg.style.display = 'none';

    cartItemsEl.innerHTML = '';

    let total = 0;

    cart.forEach((item, index) => {
      let priceNum = parseInt(item.price.replace(/\D/g, '')) || 0;
      let qty = item.quantity || 1;
      let itemTotal = priceNum * qty;
      total += itemTotal;

      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.title}</td>
        <td><img src="${item.image || ''}" alt="${item.title}"></td>
        <td>
          <button class="qty-btn" onclick="updateQuantity(${index}, -1)">−</button>
          ${qty}
          <button class="qty-btn" onclick="updateQuantity(${index}, 1)">+</button>
        </td>
        <td>${item.price}</td>
        <td>${itemTotal.toLocaleString()} VNĐ</td>
        <td><button onclick="removeItem(${index})">Xóa</button></td>
      `;
      cartItemsEl.appendChild(tr);
    });

    cartTotalEl.textContent = `Tổng tiền: ${total.toLocaleString()} VNĐ`;
  }

  function updateQuantity(index, change) {
    if (cart[index].quantity + change > 0) {
      cart[index].quantity += change;
    } else {
      cart.splice(index, 1);
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
  }

  function removeItem(index) {
    cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
  }

  checkoutBtn.addEventListener('click', () => {
    if(cart.length === 0){
      alert('Giỏ hàng trống, không thể đặt hàng!');
      return;
    }
    alert('Cảm ơn bạn đã đặt hàng! Đơn hàng của bạn sẽ được xử lý sớm.');
    cart = [];
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
  });

  renderCart();
</script>

</body>
</html>
